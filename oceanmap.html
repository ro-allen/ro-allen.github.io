<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Oceanmap Tutorial</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ro Allen</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-user"></span>
     
     Home
  </a>
</li>
<li>
  <a href="blog.html">
    <span class="fa fa-coffee"></span>
     
     Blog
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-spinner"></span>
     
     Lab Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="bioconductor.html"> Bioconductor Pipeline</a>
    </li>
    <li class="dropdown-header"> Exploratory Analysis</li>
    <li>
      <a href="oceanmap.html"> Oceanmap Tutorial</a>
    </li>
    <li>
      <a href="rchunks.html"> R Chunks</a>
    </li>
    <li>
      <a href="exres.html"> External Resources</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="publications.html">
    <span class="fa fa-mortar-board"></span>
     
     Publications
  </a>
</li>
<li>
  <a href="cv.html">
    <span class="fa fa-file-text"></span>
     
     CV
  </a>
</li>
<li>
  <a href="https://twitter.com/rojallen">
    <span class="fa fa-twitter"></span>
     
    Twitter
  </a>
</li>
<li>
  <a href="https://github.com/ro-allen">
    <span class="fa fa-github"></span>
     
    Github
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Oceanmap Tutorial</h1>

</div>


<p style="text-align:justify">
Plotting maps of ocean regions is a key skill for all marine scientists. Maps frequently feature as the opening figure of journal articles, thus producing high quality maps can form an important first impresssion for readers. Despite this, software tools for producing high-quality maps are non-trivial to use. Here, I provide a short tutorial to mapping chlorophyll-a concentration data from the MODIS-Aqua satellite in the South Pacific Ocean, using the R package <a href="https://cran.r-project.org/web/packages/oceanmap/oceanmap.pdf">oceanmap</a>.
</p>
<p>Install required packages.</p>
<pre class="r"><code>install.packages(&quot;oceanmap&quot;)
install.packages(&quot;ncdf4&quot;)
install.packages(&quot;raster&quot;)
install.packages(&quot;viridis&quot;)</code></pre>
<p style="text-align:justify">
<p>Load required packages.</p>
<pre class="r"><code>library(oceanmap)
library(ncdf4)
library(raster)
library(viridis)</code></pre>
<p style="text-align:justify">
<p>Download MODIS-Aqua satellite data from the <a href="https://oceandata.sci.gsfc.nasa.gov/MODIS-Aqua/Mapped/">NASA ocean data portal</a>. The data downloaded for this tutorial is seasonal 4 km resolution chlorophyll-a data from the Boreal Summer of 2011.</p>
<pre class="r"><code># path to downloaded MODIS-Aqua data
chl.win = (&#39;~/Desktop/PhD/Data/geotraces_transect/A20111722011263.L3m_SNSU_CHL_chlor_a_4km.nc&#39;)

# read in MODIS-Aqua data
chl.dat = nc_open(chl.win)

# convert .nc data to raster data for plotting
chl.dat.raster = nc2raster(chl.dat, &quot;chlor_a&quot;, lonname=&quot;lon&quot;, latname=&quot;lat&quot;, date=T)</code></pre>
<p style="text-align:justify">
<p>In this example, we are creating a map which spans the <a href="https://en.wikipedia.org/wiki/180th_meridian">antimeridian</a>. As a result, the longitudinal coordinates of the raster data must be converted from the -180 to 180 format, to the 0 to 360 format. This can be done using the rotate function in the Raster package.</p>
<pre class="r"><code>chl.360 = shift(raster::rotate(shift(chl.dat.raster, 180)), 180)</code></pre>
<p style="text-align:justify">
<p>In it’s current state, the chl.360 raster contains global data from the MODIS-Aqua satellite. In this case, we only want to plot the South West Pacific region. To allow this, we can crop the raster using the crop function in the Raster package. The extent argument sets the longitude minimum, longitude maximum, latitude minimum, and latitude maximum for the cropped region.</p>
<pre class="r"><code>chl.360.crop = raster::crop(chl.360, extent(c(160, 230, -50, -20))) </code></pre>
<p style="text-align:justify">
<p>Prior to plotting, we can define a colour palette for the colour bar of the upcoming figure. I personally like the <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">viridis palette</a>, but many other options are available.</p>
<pre class="r"><code>vpal = viridis(100, alpha = 1, begin = 0, end = 1, option = &quot;viridis&quot;)</code></pre>
<p style="text-align:justify">
<p>The chlorophyll-a map can now be generated using the v function in the oceanmap package. Note that coastlines are automatically included in the oceanmap package, which uses coastline data from <a href="https://www.ngdc.noaa.gov/mgg/shorelines/gshhs.html">GSHHS</a>. Full list of arguments can be viewed using ?v. Arguments used below: <em>cbpos</em>: the position of colour bar, <em>pal</em>: palette of colour bar, <em>zlim</em>: scale limits for colour bar, <em>cb.xlab</em>: colour bar label, <em>bwd</em>: border width, <em>grid</em>: optional grid from lon/lat tickmarks, <em>replace.na</em>: replaces na raster values with zero (not recommended), <em>Save</em>: whether to save the plot (true or false), <em>plotname</em>: plotname if saving plot (do not include file extension), <em>fileformat</em>: set file format (default “png”), <em>width</em>: plot width (inches), <em>height</em>: plot height (inches). The plot will be saved to your working directory.</p>
<pre class="r"><code>v(chl.360.crop, cbpos = &quot;r&quot;, pal = vpal, zlim = c(0,1), cb.xlab = expression(&quot;Chlorophyll-a (mg m&quot;^-3*&quot;)&quot;), bwd = 0.01, grid = F, replace.na = F, Save = T, plotname = &quot;sp_rmd_plot&quot;, fileformat = &quot;png&quot;, width = 10, height = 5)</code></pre>
<center>
<div style="width:750px; height=375px">
<div class="figure">
<img src="sp_rmd_plot.png" />

</div>
</div>
</center>
<p style="text-align:justify">
<p>Further tutorials for using the oceanmap R package, from the package author, can be accessed <a href="https://www.researchgate.net/profile/Robert_Bauer9/publication/315494507_oceanmap_Mapping_oceanographic_data/links/58d2987292851cd76d346f65/oceanmap-Mapping-oceanographic-data.pdf">here</a>.</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
